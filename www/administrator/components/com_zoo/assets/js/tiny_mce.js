/* Copyright (C) 2007 - 2010 YOOtheme GmbH, YOOtheme License (http://www.yootheme.com/license) */

Zoo.tinyMCE={};
Zoo.tinyMCE.init=function(){var a=location.href.match(/^(.+)administrator\/index\.php.*/i)[1];tinyMCE.init({plugins:"-zoo",mode:"none",theme:"advanced",theme_advanced_toolbar_location:"top",theme_advanced_buttons1:"bold, italic, underline, strikethrough, separator , justifyleft, justifycenter, justifyright, separator, bullist, numlist, separator, undo, redo, separator, link, unlink, joomlaimage, cleanup, separator, removeformat, charmap, formatselect",theme_advanced_buttons2:"",theme_advanced_buttons3:"",document_base_url:a,
theme_advanced_statusbar_location:"bottom",cleanup_callback:function(b,c){switch(b){case "get_from_editor":c=c.replace(/<(pre|script)[^>]*>[\s\S]+?<\/\1>/g,function(d){return d.replace(/<br ?\/?>[\r\n]*/g,"\n")});break;case "insert_to_editor":break}return c}})};
Zoo.tinyMCE.add=function(a,b){if(!tinyMCE.get(a)){tinyMCE.execCommand("mceAddControl",false,a);var c=$(a).getParent();c.getElement("a.toggler")||(new Element("a",{"class":"toggler button-grey"})).setText(b).injectInside(c).addEvent("click",function(){Zoo.tinyMCE.toggle(a)})}};Zoo.tinyMCE.remove=function(a){tinyMCE.execCommand("mceRemoveControl",false,a)};Zoo.tinyMCE.toggle=function(a,b){tinyMCE.get(a)?Zoo.tinyMCE.remove(a):Zoo.tinyMCE.add(a,b)};
tinymce.create("tinymce.plugins.ZooPlugin",{createControl:function(a,b){switch(a){case "joomlaimage":var c=b.createButton("joomlaimage",{title:"Insert / edit image","class":"mce_image",onclick:function(d){c=$((new Event(d)).target);id=c.getParent().getProperty("id").replace(/_joomlaimage$/,"");SqueezeBox.fromElement(c,{handler:"iframe",url:"index.php?option=com_media&view=images&tmpl=component&e_name="+id,size:{x:600,y:415}})}});return c}return null}});tinymce.PluginManager.add("zoo",tinymce.plugins.ZooPlugin);
window.addEvent("domready",function(){if($type(window.jInsertEditorText)=="function")window.insertJoomlaImageOld=window.jInsertEditorText;window.jInsertEditorText=function(a,b){if(b.match(/^tinymce-/))tinyMCE.execInstanceCommand(b,"mceInsertRawHTML",false,a);else $type(window.insertTextOld)=="function"&&window.insertJoomlaImageOld(a,b)}}); 
